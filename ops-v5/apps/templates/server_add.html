{% extends "base.html" %}

{% block breadcrumb %} 
资产管理 / 添加服务器
{% endblock %}

{% block main %}
<div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-sm-10">
                 <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>填写服务器信息</h5>
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    </div>
                    <div class="ibox-content">
                        <form id="serverForm" class="Formvalid form-horizontal nice-validator n-yellow" novalidate="novalidate">
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
                                <label for="HostName" class="col-sm-4 control-label text-right ">主机名</label>
                                    <input name="HostName" placeholder="HostName" type="text" class="form-control" aria-required="true">
                            </div>
                            <div class="form-group col-sm-6">
                                <label for="SSH_port" class="col-sm-4 control-label text-right ">SSH 端口<span class="red-fonts ">*</span></label>
                                    <input name="SSH_port" placeholder="SSH_port" type="text" class="form-control" aria-required="true">
                            </div>
                          </div>
                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
                                <label for="PrivateIP" class="col-sm-4 control-label text-right">私网 IP<span class="red-fonts">*</span></label>
                                    <input name="PrivateIP" placeholder="PrivateIP" type="text" datatype="ip" class="form-control" aria-required="true" nullmsg="请输入IP地址" errormsg="请输入正确的IP地址">
                            </div>

                            <div class="form-group col-sm-6">
                                <label for="PublicIP" class="col-sm-4 control-label text-right">公网 IP</label>
                                    <input name="PublicIP" placeholder="PublicIP" type="text" class="form-control" aria-required="true">
                            </div>
			  </div>

                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
                                <label for="ServerBrand" class="col-sm-4 control-label text-right">服务器品牌</label>
                                    <input name="ServerBrand" placeholder="ServerBrand" type="text" class="form-control" aria-required="true">
                            </div>

                            <div class="form-group col-sm-6">
                                <label for="ServerModel" class="col-sm-4 control-label text-right">服务器型号</label>
                                     <input name="ServerModel" placeholder="ServerModel" type="text" class="form-control" aria-required="true">
                            </div>
			  </div>

                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">  
                            <div class="form-group col-sm-6">
                                <label for="OS" class="col-sm-4 control-label text-right">系统版本</label>
                                     <input name="OS" placeholder="OS" type="text" class="form-control" aria-required="true">
                            </div>
                            
                            <div class="form-group col-sm-6">
                                <label for="Kernel" class="col-sm-4 control-label text-right">内核版本</label>
                                     <input name="Kernel" placeholder="Kernel" type="text" class="form-control" aria-required="true">
                            </div>
			  </div>

                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
                                <label for="CpuType" class="col-sm-4 control-label text-right">CPU 类型</label>
                                     <input name="CpuType" placeholder="CpuType" type="text" class="form-control" aria-required="true">
                            </div>

                            <div class="form-group col-sm-6">
                                <label for="CpuCount" class="col-sm-4 control-label text-right">CPU 核数</label>
                                     <input name="CpuCount" placeholder="CpuCount" type="text" class="form-control" aria-required="true">
                            </div>
			  </div>

                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
                                <label for="RAM_GB" class="col-sm-4 control-label text-right">内存</label>
                                     <input name="RAM_GB" placeholder="RAM_GB" type="text" class="form-control" aria-required="true">
			    </div>
                            <div class="form-group col-sm-6">
                                <label for="SWAP_Size" class="col-sm-4 control-label text-right">SWAP</label>
                                <input name="SWAP_Size" placeholder="SWAP_Size" type="text" class="form-control" aria-required="true">
                            </div>
			  </div>

                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
                                <label for="PhyDiskSize" class="col-sm-4 control-label text-right">物理磁盘</label>
                                     <input name="PhyDiskSize" placeholder="PhyDiskSize" type="text" class="form-control" aria-required="true">
			    </div>
                            <div class="form-group col-sm-6">
                                <label for="Part_mount" class="col-sm-4 control-label text-right">分区挂载</label>
                                <input name="Part_mount" placeholder="Part_mount" type="text" class="form-control" aria-required="true">
                            </div>
			  </div>

                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
                                <label for="IDC" class="col-sm-4 control-label text-right">机房<span class="red-fonts">*</span></label>
				<select name="IDC" id="IDC" class="form-control">
                                        <option value="阿里云华东1区">阿里云华东1区</option>
                                        <option value="阿里云华北1区">阿里云华北1区</option>
                                        <option value="北京IDC">北京IDC</option>
                                        <option value="佛山IDC">佛山IDC</option>
                                        <option value="丽丰中心33楼">丽丰中心33楼</option>
                                </select>
                            </div>
                            <div class="form-group col-sm-6">
                                <label for="ENV" class="col-sm-4 control-label text-right">所属环境<span class="red-fonts">*</span></label>
				<select name="ENV" id="ENV" class="form-control">
					<option value='online'>线上环境-online</option>
					<option value='test'>测试环境-test</option>
					<option value='dev'>开发环境-dev</option>
					<option value='ops' selected='selected'>运维环境-ops</option>
                        	</select>
                            </div>
                          </div>
                          <div class="hr-line-dashed"></div>
			  <div class="form-inline row">
                            <div class="form-group col-sm-6">
				<label class="col-sm-4 control-label text-right">状态<span class="red-fonts">*</span></label>
                                 <div class="col-sm-4">
                                        <div class="radio i-checks">
                                            <label><input type="radio" value="0" class="status" name="status" checked="">在线</label>
                                        </div>
                                    </div>
                                    
                                    <div class="col-sm-4">
                                        <div class="radio i-checks">
                                            <label><input type="radio" value="1" class="status" name="status">已下线</label>
                                        </div>
                                    </div>
                            </div>
			  </div>

                          <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <div class="col-sm-4 col-sm-offset-4">
                                    <button id="submit_button" class="btn btn-primary">添加</button>
                                    <button class="btn btn-warning" type="reset">取消</button>
				    <button class="btn btn-info" type="reset">重置</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

        $("#serverForm").Validform({
            tiptype:3,
            datatype:{
                "zh2-4" : /^[\u4E00-\u9FA5\uf900-\ufa2d]{2,4}$/,
		"ip" : /([0-9]{1,3}\.){3}[0-9]{1,3}/
            }
        });

	$("#ENV").multiselect({
            maxHeight: 200,
            buttonWidth: '200px',
            nonSelectedText: '请选择环境',
        });
	$("#IDC").multiselect({
            maxHeight: 200,
            buttonWidth: '200px',
            nonSelectedText: '请选择机房',
        });

        $("#submit_button").click(function(){
   	    var str_err=$('.Validform_wrong').text()
   	    if(!str_err){
               var str = $("#serverForm").serialize();
               $.post("/cmdb/server_add",str,function(data){
                   data=JSON.parse(data);
                   if(data["result"] == 0){
		       swal({
    		   	   title:"Good",
			   text:"添加成功",
			   type:"success",
			   confirmButtonText:"确定"
		           },
  			   function(){
 			   location.href="/cmdb/server_list";
                       })
                   }else{
		      swal("OH My God",data['msg'],"error")
                   };
               });
	   };
            return false;
        });

    </script>
{% endblock %}

